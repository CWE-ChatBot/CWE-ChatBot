# Requirements

## Functional

1.  **FR1:** The ChatBot shall accurately interpret natural language queries related to CWEs, vulnerabilities, and security best practices.
2.  **FR2:** The ChatBot shall retrieve and synthesize relevant information from the CWE corpus based on user queries.
3.  **FR3:** The ChatBot shall support basic conversational turns, allowing users to ask follow-up questions to refine information.
4.  **FR4:** The ChatBot shall adapt response content and detail based on the user's specified or inferred role (e.g., PSIRT member, Developer).
5.  **FR5:** The ChatBot shall provide both concise summaries and detailed explanations of CWEs upon user request.
6.  **FR6:** The ChatBot shall automatically suggest related CWEs, common attack patterns (e.g., OWASP Top 10), or relevant mitigation strategies based on the conversation context.
7.  \<a id="USR\_PSIRT\_INPUT"\>\</a\>**FR7: USR\_PSIRT\_INPUT** As a PSIRT member, the ChatBot MUST enable input of bug reports and issue summaries to quickly receive prioritized CWE recommendations under high time pressure.
8.  \<a id="USR\_DEV\_SOURCE\_CODE"\>\</a\>**FR8: USR\_DEV\_SOURCE\_CODE** As a developer, the ChatBot MUST support submission of source code and patch details to accurately identify correct CWE mappings without delaying bug fixes.
9.  \<a id="USR\_ACADEMIC\_ANALYSIS"\>\</a\>**FR9: USR\_ACADEMIC\_ANALYSIS** As an academic researcher, the ChatBot SHOULD enable exploration of CWE mappings with limited code context for effective analysis of vulnerability trends and detection techniques.
10. \<a id="USR\_BUG\_BOUNTY\_MAPPING"\>\</a\>**FR10: USR\_BUG\_BOUNTY\_MAPPING** As a bug bounty hunter, the ChatBot SHOULD support mapping vulnerabilities based on exploit information to ensure accurate and credible CWE reporting.
11. \<a id="USR\_PM\_RESOURCE\_ALLOCATION"\>\</a\>**FR11: USR\_PM\_RESOURCE\_ALLOCATION** As a product manager, the ChatBot SHOULD enable analysis of common weaknesses at scale to effectively allocate resources and implement preventive measures.
12. \<a id="USR\_CHATBOT\_ACCURACY"\>\</a\>**FR12: USR\_CHATBOT\_ACCURACY** As a user, the ChatBot MUST provide correct CWE IDs and names without hallucination to trust chatbot recommendations.
13. \<a id="USR\_CHATBOT\_ID\_INPUT"\>\</a\>**FR13: USR\_CHATBOT\_ID\_INPUT** As a user, the ChatBot MUST accurately accept and interpret input CWE IDs without confusing similar IDs (e.g., CWE-79 vs. CWE-89).
14. \<a id="USR\_CHATBOT\_CWE\_UPDATES"\>\</a\>**FR14: USR\_CHATBOT\_CWE\_UPDATES** As a user, the ChatBot MUST remain up-to-date with the latest CWE versions to ensure mappings reflect current standards.
15. \<a id="USR\_CHATBOT\_PRIORITY\_CONFIDENCE"\>\</a\>**FR15: USR\_CHATBOT\_PRIORITY\_CONFIDENCE** As a user, the ChatBot MUST receive prioritized and confidence-annotated CWE suggestions (limited in number) to efficiently focus on relevant mappings.
16. \<a id="USR\_CHATBOT\_REASONING"\>\</a\>**FR16: USR\_CHATBOT\_REASONING** As a user, the ChatBot SHOULD explain its reasoning (e.g., quoting mapping notes) to understand CWE recommendations.
17. \<a id="USR\_CHATBOT\_INSUFFICIENT\_INFO"\>\</a\>**FR17: USR\_CHATBOT\_INSUFFICIENT\_INFO** As a user, the ChatBot MUST gracefully handle insufficient information (e.g., indicate "not enough information") to avoid misleading confidence.
18. \<a id="USR\_CHATBOT\_FEEDBACK\_LEARNING"\>\</a\>**FR18: USR\_CHATBOT\_FEEDBACK\_LEARNING** As a user, the ChatBot SHOULD learn and continuously update its responses based on user feedback, interactions, and logs.
19. \<a id="USR\_CHATBOT\_CONFIDENTIALITY"\>\</a\>**FR19: USR\_CHATBOT\_CONFIDENTIALITY** As a user, I MUST have confidence in the ChatBot's handling of confidential information; specifically, for **self-hosted deployments**, the ChatBot MUST guarantee that internal confidential information never leaves the user's defined domain or company. For **centrally-hosted deployments**, the ChatBot SHALL ensure robust data encryption, strict access controls, and adherence to contractual data privacy agreements, preventing unauthorized access by third parties (including chatbot creators).
20. \<a id="FR\_CONFIDENCE\_HANDLING"\>\</a\>**FR20: User Confidence Handling** The ChatBot shall handle and display different confidence levels for CWE mapping recommendations.
21. \<a id="FR\_EXPLANATION\_LEVEL"\>\</a\>**FR21: User Explanation Level** The ChatBot shall provide explanations for CWE mapping recommendations adaptable to the user's desired level of detail.
22. \<a id="FR\_MAPPING\_HISTORY"\>\</a\>**FR22: Mapping History Management** The ChatBot SHOULD allow users to save or export their CWE mapping history.
23. \<a id="FR\_BATCH\_PROCESSING"\>\</a\>**FR23: Processing Scope** The ChatBot SHOULD provide options for single vulnerability analysis and consider batch processing for future phases.
24. \<a id="FR\_COLLABORATION"\>\</a\>**FR24: Collaboration & Sharing** The ChatBot SHOULD provide functionality for users to collaborate or share CWE mappings with team members.
25. \<a id="FR\_FILE\_FORMAT\_SUPPORT"\>\</a\>**FR25: Input File Format Support** The ChatBot shall support specified file formats for vulnerability descriptions and code snippets.
26. \<a id="FR\_AMBIGUOUS\_INFO"\>\</a\>**FR26: Ambiguous Information Handling** The ChatBot shall gracefully handle incomplete or ambiguous vulnerability information by seeking clarification or indicating insufficient data.
27. \<a id="FR\_REPORT\_INCORRECT\_MAPPING"\>\</a\>**FR27: Incorrect Mapping Feedback** The ChatBot SHALL provide a mechanism for users to report incorrect mappings or provide feedback.
28. \<a id="FR\_BYO\_LLM\_KEY"\>\</a\>**FR28: Bring Your Own LLM API Key** As a user, I MUST be able to configure the ChatBot to use my own Large Language Model (LLM) API key, so that I can utilize my preferred or licensed LLM services. Example GenAI tool that supports Bring Your Own LLM API Key: https://stridegpt.streamlit.app/
29. \<a id="FR\_BYO\_LLM\_MODEL"\>\</a\>**FR29: Bring Your Own Self-Hosted LLM Model** As a user, I MUST be able to configure the ChatBot to use my own self-hosted LLM model, so that I can leverage private or custom models within my own infrastructure.

## Non Functional

1.  \<a id="NFR\_PERFORMANCE\_LATENCY"\>\</a\>**NFR1: Performance - Latency** The ChatBot shall deliver responses with an average latency of less than 500ms for typical queries.
2.  \<a id="NFR\_SCALABILITY\_AUTO\_SCALING"\>\</a\>**NFR2: Scalability - Automatic Scaling** The underlying infrastructure and backend services shall be designed for automatic scalability to accommodate varying user loads.
3.  \<a id="NFR\_AVAILABILITY\_UPTIME"\>\</a\>**NFR3: Availability - Uptime** The system shall aim for 99.9% availability, minimizing unplanned downtime.
4.  \<a id="NFR\_SECURITY\_COMMUNICATION"\>\</a\>**NFR4: Security & Privacy - Secure Communication** All communication between the frontend and backend services shall be secured using HTTPS/TLS protocols.
5.  \<a id="NFR\_MAINTAINABILITY\_CODEBASE"\>\</a\>**NFR5: Maintainability & Code Quality - Codebase Adherence** The codebase shall adhere to defined clean architecture principles and coding standards to ensure long-term maintainability and readability for AI agents and human developers.
6.  \<a id="NFR\_ACCURACY\_HALLUCINATION"\>\</a\>**NFR6: Accuracy & Correctness - Hallucination Minimization** The ChatBot shall minimize instances of AI hallucination, striving for a high degree of factual accuracy and relevance in all provided information.
7.  \<a id="NFR\_SECURITY\_DATA\_LEAK"\>\</a\>**NFR7: Security & Privacy - Data Leakage Prevention** The chatbot shall not leak private user data or vulnerability details provided in-session.
8.  \<a id="NFR\_SECURITY\_RESTRICTIONS"\>\</a\>**NFR8: Security & Privacy - Function Restrictions & Abuse Prevention** It shall be restricted to CWE mapping functions and prevent abuse (e.g., code/prompt injection, SSRF).
9.  \<a id="NFR\_SECURITY\_CONFIDENTIALITY"\>\</a\>**NFR9: Security & Privacy - System Confidentiality** The system prompt and long-term memory must remain confidential; user context should be session-scoped.
10. \<a id="NFR\_SECURITY\_QUOTAS\_PER\_USER\_DOS"\>\</a\>**NFR10: Security & Privacy - Quotas & Rate Limits** The system shall implement **per-user quotas and overall rate limits** to prevent resource exhaustion, billing abuse, and mitigate potential **Denial of Service (DoS) attempts** or other forms of abuse.
11. \<a id="NFR\_SECURITY\_LOGGING"\>\</a\>**NFR11: Security & Privacy - Logging, Auditing & Reporting** Provide logging, auditing, and abuse reporting mechanisms.
12. \<a id="NFR\_EASE\_INSTALL"\>\</a\>**NFR12: Ease of Access & Openness - Installation & Access** The solution should be easy to install and access (minimal setup for users).
13. \<a id="NFR\_EASE\_REGISTRATION"\>\</a\>**NFR13: Ease of Access & Openness - Registration Models** Registration can be required; support open or invite-only access models.
14. \<a id="NFR\_EASE\_ADMIN\_ACCESS"\>\</a\>**NFR14: Ease of Access & Openness - Admin Control** Administrators must be able to disable or throttle access per user.
15. \<a id="NFR\_EASE\_TOKEN\_LIMITS"\>\</a\>**NFR15: Ease of Access & Openness - Token Management** Define input/output token limits to balance performance and cost.
16. \<a id="NFR\_EASE\_COSTS"\>\</a\>**NFR16: Ease of Access & Openness - Operational Costs** Ensure predictable operational costs for hosting entities.
17. \<a id="NFR\_ACCURACY\_ID\_VALIDATION"\>\</a\>**NFR17: Accuracy & Correctness - ID Validation** The ChatBot shall not hallucinate CWE IDs and names; it shall validate inputs (e.g., CWE-79 vs. CWE-89) and avoid made-up IDs.
18. \<a id="NFR\_ACCURACY\_CWE\_UPDATES"\>\</a\>**NFR18: Accuracy & Correctness - CWE Updates** The ChatBot shall have a simple process to update to new CWE versions and always reflect the latest standard.
19. \<a id="NFR\_ACCURACY\_KNOWLEDGE\_BASE"\>\</a\>**NFR19: Accuracy & Correctness - Knowledge Base Content** The ChatBot's knowledge base shall include Mapping Notes, Alternate Terms, Previous Entry Names, and Relationship/Terminology Notes.
20. \<a id="NFR\_ACCURACY\_CONCEPT\_CLARITY"\>\</a\>**NFR20: Accuracy & Correctness - Concept Clarity** The ChatBot shall educate users on commonly misunderstood terms (e.g., authentication vs. authorization).
21. \<a id="NFR\_ACCURACY\_DEEP\_DIVE"\>\</a\>**NFR21: Accuracy & Correctness - Deep-Dive Mode** The ChatBot shall support deep-dive mode with adjustable token budgets for detailed explanations.
22. \<a id="NFR\_MAPPING\_PRIORITIZED"\>\</a\>**NFR22: Mapping & Suggestions - Prioritization & Confidence** The ChatBot shall present a concise list of prioritized CWE recommendations with confidence scores.
23. \<a id="NFR\_MAPPING\_LIMITS"\>\</a\>**NFR23: Mapping & Suggestions - Suggestion Limits** The ChatBot shall limit the number of suggestions and avoid recommending Prohibited or Discouraged CWEs.
24. \<a id="NFR\_MAPPING\_REASONING"\>\</a\>**NFR24: Mapping & Suggestions - Explanation of Reasoning** The ChatBot shall offer explanations and mapping reasoning from CWE descriptions or notes.
25. \<a id="NFR\_MAPPING\_CHAINING"\>\</a\>**NFR25: Mapping & Suggestions - Chaining Relationships** The ChatBot shall allow chaining relationships (e.g., parent/child CWEs) when relevant.
26. \<a id="NFR\_MAPPING\_REFINE"\>\</a\>**NFR26: Mapping & Suggestions - Input Refinement Guidance** The ChatBot shall provide guidance for users to refine inputs when suggestions lack confidence.
27. \<a id="NFR\_GUIDING\_PATTERNS"\>\</a\>**NFR27: User Guidance & Interaction - Input Patterns** The ChatBot shall support common input patterns such as pasting vulnerability descriptions, CVE advisories, and tool outputs.
28. \<a id="NFR\_GUIDING\_INQUIRIES"\>\</a\>**NFR28: User Guidance & Interaction - Inquiry Types** The ChatBot shall enable inquiries like "issues similar to CWE-XXX" or alternative proposals.
29. \<a id="NFR\_GUIDING\_ADAPTIVE"\>\</a\>**NFR29: User Guidance & Interaction - Adaptive Explanations** The ChatBot shall adapt explanations to varying user expertise and clarify confusing concepts.
30. \<a id="NFR\_AIML\_MODEL\_SELECTION"\>\</a\>**NFR30: AI/ML Engine - Model Selection & Documentation** The foundational AI model(s) used shall be selected and documented (e.g., open-source vs. commercial).
31. \<a id="NFR\_AIML\_SAFETY"\>\</a\>**NFR31: AI/ML Engine - Prompt & Safety Mechanisms** Prompt templates and safety mechanisms shall guard against misuse.
32. \<a id="NFR\_DATA\_HANDLING\_SIZE\_LIMITS"\>\</a\>**NFR32: Data Handling - Input Size Limits** The system shall define and enforce size limits on submitted code or documentation.
33. \<a id="NFR\_SECURITY\_SENSITIVE\_DATA\_HANDLING\_GDPR"\>\</a\>**NFR33: Security & Privacy - Sensitive Data Handling & GDPR Compliance** The system shall ensure secure handling and isolation of all sensitive data, including **user login ID, email, and credentials (PII)**, as well as proprietary or sensitive code submissions. For **self-hosted deployments**, this includes data residency within the user's infrastructure. For **centrally-hosted deployments**, this includes strong encryption at rest and in transit, strict access policies, and **full compliance with GDPR requirements** for data processing, storage, and user rights.
34. \<a id="NFR\_SECURITY\_AUTHN\_AUTHZ"\>\</a\>**NFR34: Security & Privacy - Authentication & Authorization** The system shall implement authentication and authorization mechanisms for user access control, supporting both centralized user management (for centrally-hosted) and configurable integration with enterprise identity providers (for self-hosted).
35. \<a id="NFR\_USER\_EXPERIENCE\_CONTEXT\_PRESERVATION"\>\</a\>**NFR35: User Guidance & Interaction - Session Context Preservation** The system shall preserve a user's conversational context across sessions.
36. \<a id="NFR\_MAINTAINABILITY\_FEEDBACK\_LOOP"\>\</a\>**NFR36: Maintainability & Code Quality - Continuous Improvement Feedback Loop** The system shall have a defined process for incorporating user feedback into continuous system improvement.
37. \<a id="NFR\_INTEGRATION\_API\_ACCESS"\>\</a\>**NFR37: Architecture & Integration - API Accessibility** The ChatBot shall be accessible via a web browser and consider an API for programmatic access in post-MVP phases.
38. \<a id="NFR\_AVAILABILITY\_RESILIENCE"\>\</a\>**NFR38: Availability - Resilience & Auto-Fallover** The system shall implement resilience mechanisms, including auto-fallover, if an underlying AI model becomes inaccessible.
39. \<a id="NFR\_SECURITY\_DATA\_RETENTION\_POLICIES"\>\</a\>**NFR39: Security & Privacy - Data Retention Policies** The system shall adhere to defined data retention policies for submitted code and vulnerability information.
40. \<a id="NFR\_SECURITY\_AUDIT\_LOGGING"\>\</a\>**NFR40: Security & Privacy - Audit Logging** The system shall implement detailed logging for audit and abuse reporting purposes.
41. \<a id="NFR\_ARCHITECTURE\_STANDALONE"\>\</a\>**NFR41: Architecture & Integration - Standalone Tool / Self-Hostable** The system shall be architected as a standalone, deployable application, explicitly designed to support **self-hosting within a user's private infrastructure**. It shall also provide clear interfaces for future integration into existing security platforms.
42. \<a id="NFR\_RELIABILITY\_BACKUP\_RECOVERY"\>\</a\>**NFR42: Reliability & Operations - Backup & Recovery** The system shall implement robust backup and recovery mechanisms for all critical data and services.
43. \<a id="NFR\_INTEGRATION\_FUTURE\_TOOL\_PLANNING"\>\</a\>**NFR43: Architecture & Integration - Future Tool Integration Planning** The system should identify and plan for integration with key existing security tools in post-MVP phases.
44. \<a id="NFR\_INTEGRATION\_VCS"\>\</a\>**NFR44: Architecture & Integration - Version Control System Integration** The system shall define a strategy for potential future integration with version control systems.
45. \<a id="NFR\_DATA\_HANDLING\_EXPORT\_FORMATS"\>\</a\>**NFR45: Data Handling - Export Formats** The system SHOULD support various export formats for mapped CWEs and user history.
46. \<a id="NFR\_ACCURACY\_CONFLICT\_RESOLUTION"\>\</a\>**NFR46: Accuracy & Correctness - Conflict Resolution Guidance** The ChatBot shall provide mechanisms or guidance for resolving conflicts between multiple possible CWE mappings.
47. \<a id="NFR\_SECURITY\_APP\_TESTING"\>\</a\>**NFR47: Security & Privacy - Application Security Testing** The system shall undergo regular and comprehensive security testing including:
      * **Static Application Security Testing (SAST):** Automated code analysis shall be performed in the CI/CD pipeline for every pull request or significant commit.
      * **Dynamic Application Security Testing (DAST):** Automated vulnerability scanning shall be performed on deployed environments (e.g., staging, pre-production) at least weekly.
      * **LLM-based Security Reviews:** Automated or semi-automated security code reviews leveraging LLM capabilities for identifying potential weaknesses and anti-patterns shall be integrated into the development workflow.
      * **Manual Penetration Testing:** External penetration tests shall be conducted annually, and additionally on major feature releases or significant architectural changes.
48. \<a id="NFR\_MAINTAINABILITY\_TECH\_DEBT"\>\</a\>**NFR48: Maintainability & Code Quality - Technical Debt Management** The project shall manage technical debt through a multi-pronged approach:
      * **Continuous Automated Checks:** Traditional Python static analysis tools (e.g., linters, code duplication detectors, complexity analyzers) shall be run continuously in the development workflow to provide immediate feedback on code quality and identify minor technical debt as it arises.
      * **Epic-Level Technical Debt Review:** A dedicated technical debt review shall be conducted after the delivery of each epic, and before commencing the next epic. This review will involve a combination of:
          * Automated analysis using **traditional Python static analysis tools**.
          * **LLM-based code reviews** for identifying complex patterns, potential refactoring opportunities, and architectural adherence.
          * **Manual peer review** by senior developers or architects.
      * Identified technical debt will be logged, prioritized, and addressed as part of the regular development backlog or dedicated refactoring sprints.
49. \<a id="NFR\_MAINTAINABILITY\_CONTRACT\_DOCS"\>\</a\>**NFR49: Maintainability & Code Quality - Contract-Centric Documentation** The project shall adopt a **contract-centric software engineering approach**, where **documentation artifacts are treated as living contracts** for system behavior, interfaces, and architecture. Documentation (including API specifications, architectural decisions, module READMEs, and key design patterns) shall **"live with the code"**. This means:
      * It will **inform the code** by serving as a primary source of truth for implementation.
      * It will **be informed by the code** through automated generation or validation where feasible.
      * It will be **kept in sync with the code** through dedicated processes (e.g., CI/CD checks, regular review cycles) to ensure accuracy and prevent drift.
      * This approach is critical for enhancing both human and AI agent productivity and understanding of the codebase.
50. \<a id="NFR\_CLARITY\_COMMUNICATION\_PLAN"\>\</a\>**NFR50: Clarity & Communication - Stakeholder Communication Plan** The project shall maintain a clear communication strategy to keep stakeholders informed about key updates, progress, and significant changes. This includes regular status reports, release announcements, and dedicated forums for feedback.
51. \<a id="NFR\_CLARITY\_APPROVAL\_PROCESS"\>\</a\>**NFR51: Clarity & Communication - Decision Approval Process** A defined approval process shall be followed for all major project decisions and significant changes to core documentation artifacts (e.g., PRD, Architecture Document). Key approvals will typically require explicit sign-off from the Product Owner and relevant technical leads or architects.
